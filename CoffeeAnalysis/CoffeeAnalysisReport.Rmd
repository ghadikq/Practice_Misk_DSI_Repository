---
title: "Coffee Analysis Report"
author: "Ghadi K"
date: "19-10-2020"
output: 
  html_document:
    theme: paper
    toc: true
    toc_depth: 4
    toc_float:
      collapsed: false
---

```{r, echo=FALSE , warning=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(DT)
library(RColorBrewer)

coffee_ratings <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-07-07/coffee_ratings.csv')

```

After read and explor dataset I was wondering if there is realation between the coffee bean origin country and coffee aroma.

### Dose Coffee Bean Origin Don't Affect Coffee Aroma?

This report will show you if the country of origin affect the coffee aroma.

The dataset used in this report coffee_ratings dataset.

```{r, echo=FALSE , warning=FALSE, message=FALSE}
# choce the colums i need & clean data 
CoffeeAnalysisData <- coffee_ratings %>% 
  select(species,aroma,total_cup_points,country_of_origin)

drop_na(CoffeeAnalysisData)
CoffeeAnalysisData = CoffeeAnalysisData[-which(is.na(CoffeeAnalysisData$country_of_origin)),]

```

# Descriptive Statistics
The mean and standard deviation of Aroma for each Country of origin.
```{r, echo=FALSE, warning=FALSE, message=FALSE}
coffeeTable <- CoffeeAnalysisData %>% 
  group_by(country_of_origin) %>% 
  summarise(n = length(country_of_origin),
            Average = mean(aroma),
            SD = sd(aroma))
datatable(coffeeTable)
```

# Data Visualization

## Bar Plot

```{r, echo=FALSE , warning=FALSE, message=FALSE}
# Outside bars
ggplot(data=CoffeeAnalysisData, aes(x=country_of_origin, y=aroma)) +
  geom_bar(stat="identity", fill="#a6611a")+
  coord_flip()+
  geom_text(aes(label=""), vjust=-0.3, size=3.5)+
  theme_minimal()

```


## Normal Distirbution

```{r, echo=FALSE , warning=FALSE, message=FALSE}
set.seed(136)
popu_Aroma_Country <- rnorm(CoffeeAnalysisData$country_of_origin, 
                              mean = mean(CoffeeAnalysisData$aroma),
                              sd = sd(CoffeeAnalysisData$aroma))
hist(popu_Aroma_Country, breaks = 100, main = "A normally-distributed population")
```

```{r, echo=FALSE , warning=FALSE, message=FALSE}
# Simple Bar Plot
counts <- table(CoffeeAnalysisData$aroma)
barplot(counts, main="Aroma Distribution",
   xlab="Grade of Aroma")

```


# The ANOVA summary
I apply ANOVA to determine if there is really a relation between Country of origin and aroma.

```{r, echo=FALSE , warning=FALSE, message=FALSE}
library(pander)

res.aov <- aov(aroma ~ country_of_origin, data = CoffeeAnalysisData)
ANOVATable <- summary(res.aov)

pander(ANOVATable, style='rmarkdown')

```

After applying the ANOVA model it became clear that is reasonable to say that country of origin affects the coffee aroma. And the aroma change depending on country of origin.



### Try CI
```{r, echo=FALSE , warning=FALSE, message=FALSE}
# Data
coffee_from_Colombia2 <- CoffeeAnalysisData$aroma[CoffeeAnalysisData$country_of_origin == "Colombia"]

# n
n <- length(coffee_from_Colombia2)

# Mean
aromaCol_mean <- sum(coffee_from_Colombia2)/n

# Variance
aromaCol_var <- sum((coffee_from_Colombia2 - aromaCol_mean)^2)/(length(coffee_from_Colombia2) - 1)

# Standard deviation
aromaCol_sd <- sqrt(aromaCol_var)

aromaCol_mean
aromaCol_var
aromaCol_sd
```



### Try 95% CI

```{r, echo=FALSE , warning=FALSE, message=FALSE}
n
aromaCol_sd
aromaCol_mean

SEM <- aromaCol_sd/sqrt(n)

CI_lower <- aromaCol_mean - (1.96 * SEM)
CI_upper <- aromaCol_mean + (1.96 * SEM)

```

95% of the Aroma if Country of origin is Columbia are expected to have a height between [0.2684212- 7.65306]





